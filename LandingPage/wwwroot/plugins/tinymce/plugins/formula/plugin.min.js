!function (t) { function n(t, n) { t.windowManager.openUrl({ title: "Formula", url: e(t, n), buttons: [{ type: "cancel", name: "closeButton", text: "Cancel" }, { type: "custom", name: "submitButton", text: "Insert Formula" }], onCancel: function (t) { }, onAction: function (n) { for (var e, a = window.frames.length, o = 0; o < a; o++)window.frames[o].location.pathname.indexOf("formula/index.html") > 0 && (e = window.frames[o]); e && e.getData ? e.getData(function (e, a, o) { e && t.insertContent('<img class="fm-editor-equation" src="' + e + '" data-mlang="' + a + '" data-equation="' + encodeURIComponent(o) + '"/>'), n.close() }) : n.close() } }) } function e(t, n) { var e = t.selection.getNode(), a = t.getParam("language") || "en", o = "", i = ""; return "img" == e.nodeName.toLowerCase() && e.className.indexOf("fm-editor-equation") > -1 && (e.getAttribute("data-mlang") && (o = "&mlang=" + e.getAttribute("data-mlang")), e.getAttribute("data-equation") && (i = "&equation=" + e.getAttribute("data-equation"))), n + "/index.html?lang=" + a + o + i } t.create("tinymce.plugins.Formula", { init: function (t, e) { var a = (t.getParam("formula") || {}).path || e; console.log(a, t), t.ui.registry.addButton("formula", { icon: a + "/img/formula.png", tooltip: "Insert Formula", onAction: n.bind(this, t, a), onSetup: function (n) { const e = function (t) { n.setDisabled(t.element.className.indexOf("fm-editor-equation") > -1 && "img" == t.element.nodeName.toLowerCase()) }; return t.on("NodeChange", e), function (n) { t.off("NodeChange", e) } } }) } }), t.PluginManager.requireLangPack("formula", "en,es,fr_FR"), t.PluginManager.add("formula", t.plugins.Formula) }(window.tinymce);